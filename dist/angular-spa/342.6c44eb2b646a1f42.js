"use strict";(self.webpackChunkAngularSPA=self.webpackChunkAngularSPA||[]).push([[342],{2342:(I,c,m)=>{m.r(c),m.d(c,{LoginModule:()=>L});var l=m(6895),u=m(7163),s=m(433);class f{constructor(i,e,r){this.password=e,this.email=i,this.userAgent=r}}var g=m(5983),d=m(2340),t=m(1571),p=m(6858),h=m(1608),F=m(7185),b=m(2611);let _=(()=>{class o{constructor(){}getUserAgent(){return window.navigator.userAgent}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function v(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(a){t.CHM(e);const n=t.oxw(2);return t.KtG(n.handleFormSubmit(a))})("keydown",function(a){t.CHM(e);const n=t.oxw(2);return t.KtG(n.handleEnterPress(a))}),t._uU(1,"Submit"),t.qZA()}}function w(o,i){1&o&&(t.TgZ(0,"div",13)(1,"span",14),t._uU(2,"Loading..."),t.qZA()())}function T(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"form",3),t.NdJ("keydown",function(a){t.CHM(e);const n=t.oxw();return t.KtG(n.handleEnterPress(a))}),t.TgZ(1,"div",4)(2,"label",5),t._uU(3,"Email"),t.qZA(),t._UZ(4,"input",6),t.qZA(),t.TgZ(5,"div",4)(6,"label",7),t._uU(7,"Password"),t.qZA(),t._UZ(8,"input",8),t.TgZ(9,"a",9),t._uU(10,"Forgot Password?"),t.qZA()(),t.YNc(11,v,2,0,"button",10),t.YNc(12,w,3,0,"div",11),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("formGroup",e.loginForm),t.xp6(11),t.Q6J("ngIf",!e.isSubmitClicked),t.xp6(1),t.Q6J("ngIf",e.isSubmitClicked)}}function C(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(a){t.CHM(e);const n=t.oxw(2);return t.KtG(n.twoFactorCodeSubmit(a))}),t._uU(1,"Submit"),t.qZA()}}function y(o,i){1&o&&(t.TgZ(0,"div",13)(1,"span",14),t._uU(2,"Loading..."),t.qZA()())}function A(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"form",3),t.NdJ("keydown",function(a){t.CHM(e);const n=t.oxw();return t.KtG(n.handleTwoFactorEnterPress(a))}),t.TgZ(1,"div",4)(2,"label",15),t._uU(3,"Code"),t.qZA(),t._UZ(4,"input",16),t.qZA(),t.YNc(5,C,2,0,"button",17),t.YNc(6,y,3,0,"div",11),t.qZA()}if(2&o){const e=t.oxw();t.Q6J("formGroup",e.twoFAForm),t.xp6(5),t.Q6J("ngIf",!e.isTwoFactorFormSubmitted),t.xp6(1),t.Q6J("ngIf",e.isTwoFactorFormSubmitted)}}const Z=[{path:"",component:(()=>{class o{constructor(e,r,a,n,S,U,x){this.formBuilder=e,this.http=r,this.router=a,this.navbarEmitter=n,this.toastr=S,this.authGuard=U,this.userAgent=x,this.apiUrl=d.N.apiUrl+"UserLogin",this.isFormValid=!1,this.isSubmitClicked=!1,this.isTwoFactorForm=!1,this.isTwoFactorFormSubmitted=!1,this.loginForm=this.formBuilder.group({email:["mtmulch0191@outlook.com",[s.kI.required,s.kI.email]],password:["Testing12345!@",[s.kI.required,g.ym]]}),this.twoFAForm=this.formBuilder.group({code:["93974716",[s.kI.required,s.kI.minLength(8)]]})}ngOnInit(){}handleFormSubmit(e){this.loginForm.valid&&!this.isSubmitClicked?(this.isSubmitClicked=!0,this.isFormValid=!0,this.http.post(this.apiUrl,this.createFormObject()).subscribe(r=>{this.toastr.success("",r.message),this.isSubmitClicked=!1,this.loginForm.reset(),localStorage.setItem("token",r.token),!0===r.twoFactorAuth?(this.isTwoFactorForm=!0,this.navbarEmitter.navbarEvents("user-logged-in")):this.router.navigate(["/user-home"])},r=>{console.error(r),this.toastr.error("",r.error.error),this.isSubmitClicked=!1})):this.isFormValid=!1}createFormObject(){return new f(this.loginForm.value.email,this.loginForm.value.password,this.userAgent.getUserAgent())}handleEnterPress(e){13===e.keyCode&&this.handleFormSubmit(e)}handleTwoFactorEnterPress(e){13===e.keyCode&&this.twoFactorCodeSubmit(e)}twoFactorCodeSubmit(e){if(!this.isTwoFactorFormSubmitted&&this.twoFAForm.valid){this.isTwoFactorFormSubmitted=!0;let r=this.authGuard.getDecodedToken(),a=this.getPutTwoFAVerificationBody(r);this.http.putAuthenticated(d.N.apiUrl+"UserLogin/ValidateHotpCode",a).subscribe(n=>{this.isTwoFactorFormSubmitted=!1,this.toastr.success(n.message,""),setTimeout(()=>{this.router.navigate(["/user-home"])},1500)},n=>{this.isTwoFactorFormSubmitted=!1,this.toastr.error(n.error.error,"")})}}getPutTwoFAVerificationBody(e){return{UserId:e.id,HotpCode:this.twoFAForm.value.code}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(s.qu),t.Y36(p.O),t.Y36(u.F0),t.Y36(h.K),t.Y36(F._W),t.Y36(b.P),t.Y36(_))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-login"]],decls:12,vars:2,consts:[[1,"row"],[1,"col"],[3,"formGroup","keydown",4,"ngIf"],[3,"formGroup","keydown"],[1,"mb-3"],["for","email-input",1,"form-label"],["type","email","id","email-input","aria-describedby","emailHelp","formControlName","email",1,"form-control"],["for","password-input",1,"form-label"],["type","password","id","password-input","formControlName","password",1,"form-control"],["href","","routerLink","/forgot-password"],["type","button","class","btn btn-primary",3,"click","keydown",4,"ngIf"],["class","spinner-border text-primary","role","status",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click","keydown"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["for","code-input",1,"form-label"],["type","code","id","code-input","aria-describedby","codeHelp","formControlName","code",1,"form-control"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"div",1),t.TgZ(2,"div",1)(3,"h2"),t._uU(4,"Login"),t.qZA()(),t._UZ(5,"div",1),t.qZA(),t.TgZ(6,"div",0),t._UZ(7,"div",1),t.TgZ(8,"div",1),t.YNc(9,T,13,3,"form",2),t.YNc(10,A,7,3,"form",2),t.qZA(),t._UZ(11,"div",1),t.qZA()),2&e&&(t.xp6(9),t.Q6J("ngIf",!r.isTwoFactorForm),t.xp6(1),t.Q6J("ngIf",r.isTwoFactorForm))},dependencies:[l.O5,u.yS,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u]}),o})()}];let k=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.Bz.forChild(Z),u.Bz]}),o})(),L=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[l.ez,k,s.UX]}),o})()}}]);